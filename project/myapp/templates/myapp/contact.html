

{% extends 'myapp/base.html' %}

{% block title %}Contact - Cepedoza, Ma. Via{% endblock %}

{% block content %}
  <h1>Contact</h1>
  <p><em>Note: This is a demo form. Messages are not stored.</em></p>

  {% if submitted %}
    <div class="card" style="border-left:6px solid #06b6d4; margin-bottom:1rem;">
      <p>Your message was successfully sent to the demo API!</p>
      <p><small>(This simulates JSONPlaceholder behavior.)</small></p>
    </div>
  {% endif %}

  <form id="contact-form" method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn">Send</button>
  </form>
{% endblock %}

{% block extra_js %}
<script>
  
  const form = document.getElementById('contact-form');
  form.addEventListener('submit', function(e){
    e.preventDefault();
    
    const data = new FormData(form);
    const payload = {};
    data.forEach((v,k)=> payload[k]=v);

    fetch('https://jsonplaceholder.typicode.com/posts', {
      method: 'POST',
      body: JSON.stringify(payload),
      headers: {
        'Content-Type': 'application/json; charset=UTF-8'
      }
    })
    .then(res => res.json())
    .then(json => {
      alert('Message submitted to demo API! Check console for response.');
      console.log('JSONPlaceholder response:', json);
      form.reset();
    })
    .catch(err => alert('Error sending message'));
  });
</script>
{% endblock %}
